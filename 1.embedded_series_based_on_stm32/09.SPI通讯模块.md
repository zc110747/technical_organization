# **单片机总结系列(九) SPI通讯模块**

SPI是4线全双工的通讯总线，可以用于芯片和芯片，芯片和器件之间的数据传输通讯。对于STM32的SPI接口，支持主从两种模式，作为主模式时主要用于访问外部器件，常见的有SPI_FLASH，3轴加速度计，外部ADC采样芯片，当然也可以通过SPI访问其它从设备。从模式则只能作为被动器件，应答其它主SPI设备的通讯。SPI设计上为主从结构，在工作时通过主机提供时钟触发信号，在发送数据的同时从接收引脚上读取数据，同时实现数据接收和发送功能。 SPI设计上没有类似I2C的地址来区分从机设备，对于多从机的通讯，需要依赖CS引脚来选中芯片工作，且同时只能有一个芯片使能，否则会发生总线竞争，从而导致读取数据异常。

1. 片选CS, 芯片使能控制脚，低电平有效居多，当CS为高时芯片不工作，可通过多个CS脚，控制芯片的开关从而实现一路SPI访问多颗芯片。
2. 时钟CLS，时钟引脚，由主机发出，为主从机通讯提供同步时钟。
3. 主机输出接口(MOSI)，主机数据输出脚，配合Clock同步发出数据。
4. 主机输入接口(MISO)，主机数据输入脚，根据Clock接收数据。

## 